<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบบันทึกข้อมูลข้าวโพด</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes blob {
            0% {
                transform: translate(0px, 0px) scale(1);
            }

            33% {
                transform: translate(30px, -50px) scale(1.1);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }

            100% {
                transform: translate(0px, 0px) scale(1);
            }
        }

        .animate-blob {
            animation: blob 7s infinite;
        }

        .animation-delay-2000 {
            animation-delay: 2s;
        }

        .animation-delay-4000 {
            animation-delay: 4s;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 0.6s ease-out;
        }

        @keyframes slide-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-slide-up {
            animation: slide-up 0.4s ease-out;
        }

        @keyframes bounce-in {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }

            50% {
                transform: scale(1.05);
            }

            70% {
                transform: scale(0.9);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-bounce-in {
            animation: bounce-in 0.5s ease-out;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icons (simplified)
        const Sprout = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M7 20h10" />
                <path d="M10 20c5.5-2.5.8-6.4 3-10" />
                <path d="M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z" />
                <path d="M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z" />
            </svg>
        );

        const Send = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="m22 2-7 20-4-9-9-4Z" />
                <path d="M22 2 11 13" />
            </svg>
        );

        const TrendingUp = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17" />
                <polyline points="16 7 22 7 22 13" />
            </svg>
        );

        const CheckCircle2 = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10" />
                <path d="m9 12 2 2 4-4" />
            </svg>
        );

        function RiceDataApp() {
            const [formData, setFormData] = useState({
                species: '',
                zone: '',
                grade: '',
                plan: '',
                actual: '',
                area: ''
            });

            const [result, setResult] = useState(null);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [showSuccess, setShowSuccess] = useState(false);
            const [errors, setErrors] = useState({});

            const species = [
                '#71',
                '#51',
                '#55',
                '#57',
                '#SB04',
                '#60',
                '#61',
                '#63'
            ];

            const zones = [
                'NMA',
                'CPM',
                'SKT',
                'KPP',
                'SPB',
                'TAK',
                'PRE',
                'LPN',
                'LPG'
            ];

            const grades = ['GF', 'GF1', 'GF2', 'GF3', 'YF', 'RF'];

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
                if (errors[name]) {
                    setErrors(prev => ({ ...prev, [name]: '' }));
                }
            };

            const calculateYield = () => {
                const actual = parseFloat(formData.actual);
                const area = parseFloat(formData.area);
                if (actual && area && area > 0) {
                    return ((actual * 1000) / area).toFixed(2);
                }
                return null;
            };

            const validate = () => {
                const newErrors = {};
                if (!formData.species) newErrors.species = 'กรุณาเลือกสายพันธุ์';
                if (!formData.zone) newErrors.zone = 'กรุณาเลือกเขต';
                if (!formData.grade) newErrors.grade = 'กรุณาเลือกเกรด';
                if (!formData.plan) newErrors.plan = 'กรุณากรอกแผน';
                if (!formData.actual) newErrors.actual = 'กรุณากรอกเข้าจริง';
                if (!formData.area) newErrors.area = 'กรุณากรอกจำนวนไร่';

                if (formData.actual && isNaN(parseFloat(formData.actual))) {
                    newErrors.actual = 'กรุณากรอกตัวเลขเท่านั้น';
                }
                if (formData.area && isNaN(parseFloat(formData.area))) {
                    newErrors.area = 'กรุณากรอกตัวเลขเท่านั้น';
                }

                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async () => {
                if (!validate()) return;

                setIsSubmitting(true);
                const yieldResult = calculateYield();
                setResult(yieldResult);

                // แทนที่ 'YOUR_GOOGLE_SCRIPT_URL' ด้วย URL จาก Google Apps Script
                try {
                    const response = await fetch('https://script.google.com/macros/s/AKfycbzMllnBWB_40pBd5pjW4dl0mn69FK4AotmzTWL6Xl216LFi3EvIH6p4BASzLI_9skY/exec', {
                        method: 'POST',
                        mode: "no-cors",
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            ...formData,
                            yield: yieldResult
                        })
                    });

                    // ถ้าไม่มี Google Script ให้ใช้ timeout จำลอง
                    // await new Promise(resolve => setTimeout(resolve, 1500));
                } catch (error) {
                    console.error('Error:', error);
                    // จำลองการส่งข้อมูลสำเร็จ
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }

                setIsSubmitting(false);
                setShowSuccess(true);

                setTimeout(() => {
                    setShowSuccess(false);
                    setFormData({
                        species: '',
                        zone: '',
                        grade: '',
                        plan: '',
                        actual: '',
                        area: ''
                    });
                    setResult(null);
                }, 3000);
            };

            return (
                <div className="min-h-screen p-4 md:p-8 relative bg-cover bg-center bg-no-repeat bg-fixed" style={{ backgroundImage: "url('background.jpg')" }}>
                    <div className="fixed inset-0 bg-black/30 backdrop-blur-[2px]"></div>
                    <div className="fixed inset-0 overflow-hidden pointer-events-none">
                        <div className="absolute top-20 left-10 w-72 h-72 bg-green-400 rounded-full mix-blend-overlay filter blur-3xl opacity-20 animate-blob"></div>
                        <div className="absolute top-40 right-10 w-72 h-72 bg-emerald-400 rounded-full mix-blend-overlay filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>
                        <div className="absolute -bottom-8 left-20 w-72 h-72 bg-teal-400 rounded-full mix-blend-overlay filter blur-3xl opacity-20 animate-blob animation-delay-4000"></div>
                    </div>

                    <div className="max-w-2xl mx-auto relative">
                        <div className="text-center mb-8 animate-fade-in">
                            <div className="flex justify-center mb-4">
                                <div className="bg-gradient-to-br from-green-500 to-emerald-600 p-4 rounded-2xl shadow-lg transform hover:scale-110 transition-transform duration-300">
                                    <Sprout />
                                </div>
                            </div>
                            <h1 className="text-4xl md:text-5xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent mb-2 leading-tight pb-2">
                                ระบบบันทึกข้อมูลข้าวโพด
                            </h1>
                            <p className="text-gray-600 text-lg">บันทึกและวิเคราะห์ผลผลิตข้าวโพด</p>
                        </div>

                        <div className="bg-white/40 backdrop-blur-md rounded-3xl shadow-2xl p-8 border border-white/20">
                            <div className="space-y-6">
                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        สายพันธุ์ข้าวโพด
                                    </label>
                                    <select
                                        name="species"
                                        value={formData.species}
                                        onChange={handleChange}
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.species ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    >
                                        <option value="">-- เลือกสายพันธุ์ --</option>
                                        {species.map((s, i) => (
                                            <option key={i} value={s}>{s}</option>
                                        ))}
                                    </select>
                                    {errors.species && <p className="text-red-500 text-sm mt-1">{errors.species}</p>}
                                </div>

                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        เขตพื้นที่
                                    </label>
                                    <select
                                        name="zone"
                                        value={formData.zone}
                                        onChange={handleChange}
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.zone ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    >
                                        <option value="">-- เลือกเขต --</option>
                                        {zones.map((z, i) => (
                                            <option key={i} value={z}>{z}</option>
                                        ))}
                                    </select>
                                    {errors.zone && <p className="text-red-500 text-sm mt-1">{errors.zone}</p>}
                                </div>

                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        เกรด
                                    </label>
                                    <select
                                        name="grade"
                                        value={formData.grade}
                                        onChange={handleChange}
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.grade ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    >
                                        <option value="">-- เลือกเกรด --</option>
                                        {grades.map((g, i) => (
                                            <option key={i} value={g}>{g}</option>
                                        ))}
                                    </select>
                                    {errors.grade && <p className="text-red-500 text-sm mt-1">{errors.grade}</p>}
                                </div>

                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        แผน (ตัน)
                                    </label>
                                    <input
                                        type="text"
                                        name="plan"
                                        value={formData.plan}
                                        onChange={handleChange}
                                        placeholder="กรอกจำนวนตามแผน"
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.plan ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    />
                                    {errors.plan && <p className="text-red-500 text-sm mt-1">{errors.plan}</p>}
                                </div>

                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        เข้าจริง (ตัน)
                                    </label>
                                    <input
                                        type="text"
                                        name="actual"
                                        value={formData.actual}
                                        onChange={handleChange}
                                        placeholder="กรอกจำนวนที่ได้จริง"
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.actual ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    />
                                    {errors.actual && <p className="text-red-500 text-sm mt-1">{errors.actual}</p>}
                                </div>

                                <div className="transform transition-all duration-300 hover:scale-[1.02]">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        จำนวนไร่
                                    </label>
                                    <input
                                        type="text"
                                        name="area"
                                        value={formData.area}
                                        onChange={handleChange}
                                        placeholder="กรอกจำนวนไร่"
                                        className={`w-full px-4 py-3 rounded-xl border-2 ${errors.area ? 'border-red-400' : 'border-gray-200'
                                            } focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all outline-none bg-white/50`}
                                    />
                                    {errors.area && <p className="text-red-500 text-sm mt-1">{errors.area}</p>}
                                </div>

                                {result && (
                                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 border-2 border-green-200 animate-slide-up">
                                        <div className="flex items-center gap-3 mb-2">
                                            <TrendingUp className="text-green-600" />
                                            <h3 className="text-lg font-bold text-gray-800">ผลผลิตต่อไร่</h3>
                                        </div>
                                        <div className="text-4xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent">
                                            {result} กก./ไร่
                                        </div>
                                    </div>
                                )}

                                <button
                                    onClick={handleSubmit}
                                    disabled={isSubmitting}
                                    className="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                                >
                                    {isSubmitting ? (
                                        <>
                                            <div className="w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"></div>
                                            กำลังส่งข้อมูล...
                                        </>
                                    ) : (
                                        <>
                                            <Send />
                                            บันทึกข้อมูล
                                        </>
                                    )}
                                </button>
                            </div>
                        </div>

                        {showSuccess && (
                            <div className="fixed inset-0 flex items-center justify-center z-50 animate-fade-in">
                                <div className="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>
                                <div className="bg-white rounded-3xl p-8 shadow-2xl transform scale-100 animate-bounce-in relative">
                                    <div className="flex flex-col items-center gap-4">
                                        <div className="bg-green-100 rounded-full p-4">
                                            <CheckCircle2 className="text-green-600" />
                                        </div>
                                        <h2 className="text-2xl font-bold text-gray-800">บันทึกสำเร็จ!</h2>
                                        <p className="text-gray-600">ข้อมูลถูกบันทึกแล้ว</p>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<RiceDataApp />, document.getElementById('root'));
    </script>
</body>

</html>